name: Data Schema Code Convention Check

on:
  push:
    paths:
      - 'DataSchema.json'
      - 'DataSchema.sql'
      - '.github/workflows/DataSchemaCodeConvention.yml'

jobs:
  validate:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      # --- JSON lint ---
      - name: Install jsonlint
        run: npm install -g @prantlf/jsonlint

      - name: Validate JSON schema
        run: jsonlint DataSchema.json

      # --- SQL lint ---
      - name: Install sqlfluff
        run: pip install sqlfluff

      - name: Validate SQL schema
        run: sqlfluff lint DataSchema.sql --dialect postgres

